---
title: "An analysis of woodland engagement and socio-demographic profile in Wale's People and Nature Survey (2020/21)"
author: Daniel Braby
description: "Programme 3: Societal benefits of trees, woods and forests"
date: today
date-format: "D MMMM YYYY"
embed-resources: TRUE
format:
  html
editor: visual
editor_options: 
  chunk_output_type: console
---



```{r}
#| include: false

require(magrittr)

pans_y2 <- haven::read_sav("wales_21.sav") %>%
  janitor::clean_names()

pans_y2 <- pans_y2 %>%
  dplyr::select(m1_q2_4, m2a_q2, no_of_visits, age_band, qualification, income, home_imd_decile, ethnicity) %>%
  dplyr::rename(woodland_visit = m1_q2_4)


pans_y2 <- pans_y2 %>%
  dplyr::mutate(dplyr::across(-woodland_visit, ~ if (sjlabelled::is_labelled(.)) as.character(sjlabelled::as_label(.)) else .)) %>%
  dplyr::mutate(dplyr::across(-woodland_visit, as.factor)) 


m1_q2_4 <- pans_y2 %>% 
  dplyr::select(-m2a_q2,
                -no_of_visits) %>%
  dplyr::filter(!income %in% c("Don’t know", "Prefer not to say")) %>%
  dplyr::mutate(
    income = forcats::fct_relevel(
      income,
      "£0–14,999",
      "£15,000–19,999",
      "£20,000–29,999",
      "£30,000–39,999",
      "£40,000–49,999",
      "£50,000–59,999",
      "£60,000–79,999",
      "£80,000–99,999",
      "£100,000-£149,999",
      "£150,000 +"
    )
  )
  



## Breakdown of socio-demographic profile

create_summary_table <- function(data, var, target = "woodland_visit") {
  data %>%
    dplyr::group_by(.data[[var]], .data[[target]]) %>%
    dplyr::summarise(count = dplyr::n(), .groups = "drop") %>%
    dplyr::group_by(.data[[target]]) %>%
    dplyr::mutate(percent = count / sum(count)) %>%
    dplyr::mutate(label = paste0(count, " (", scales::percent(percent, accuracy = 1), ")")) %>%
    dplyr::select(category = .data[[var]], visited = .data[[target]], label) %>%
    tidyr::pivot_wider(names_from = visited,
                       values_from = label,
                       values_fill = "0 (0%)") %>%
    dplyr::rename(`Socio-demographic characteristic` = category,
                  `Did not visit wooland in last month` = `0`,
                  `Visited woodland in last month` = `1`)
    
}

```



# Methodology

## Study design and sample

Data were from year 2 of the [People and Nature Survey](https://beta.ukdataservice.ac.uk/datacatalogue/series/series?id=2000125) (PANS) for Wales (Natural Resources Wales, 2022). PANS is a nationally representative omnibus survey commissioned by Natural Resources Wales which gathers information on people's engagement, understanding and attitude towards the natural environment. Data were collected online (by Kantar). The survey builds on the Monitor of Engagement with the Natural Environment (MENE) survey which ran from 2009 to 2019.

## Data

Woodland engagement was estimated by asking *Which of the following type(s) of green and natural spaces have you visited during the last month?* (M1_Q2_4). Of the 5,954 respondents, 2,125 (36%) answered yes they had visited woodland or forest.

The following socio-demographic characteristics were controlled for in the analysis: age, education (level of highest qualification), employment status, ethnicity, gender, Index of Multiple Deprivation (IMD) decile, income, home region, and urban-rural classification. Socio-demographic characteristics are summarised in Table 1.

#### Table 1: Breakdown of socio-demographic profile

```{r}
#| echo: FALSE
#| message: false
#| warning: false

create_summary_table(m1_q2_4, "age_band") %>%
  knitr::kable()

create_summary_table(m1_q2_4, "qualification") %>%
  knitr::kable()

create_summary_table(m1_q2_4, "income") %>%
  knitr::kable()

create_summary_table(m1_q2_4, "home_imd_decile") %>%
  knitr::kable()

create_summary_table(m1_q2_4, "ethnicity") %>%
  knitr::kable()



```


Analyses were conducted in R 4.2.1 (R Core Team, 2022). We used generalised linear modelling to investigate the association between woodland engagement (dependent/response variable) and socio-demographic profile (independent variables/predictors).


Significant socio-demographic characteristics were identified based on Analysis of Variance (ANOVA) using likelihood ratio chi-squared statistics (Fox & Weisberg, 2019). Estimated marginal means for each socio-demographic characteristic were estimated post-hoc using the `ggemmeans()` function in the `{ggeffects}` package (Lüdecke, 2018). Model fit statistics (AIC, $w_i$, Tjur's $R^2$) were calculated using the `{performance}` package (Lüdecke, 2021).

# Results

```{r}
#| include: false

y2_model <- glm(woodland_visit ~.,
                data = m1_q2_4,
                family = "binomial")

summary(y2_model)
```

Summary of Findings: Factors Influencing Woodland Visits in the Last Month

Model Overview
	•	Dependent Variable (Y): Respondent visited woodland in the last month (binary outcome).
	•	Model Type: Logistic regression.
	•	Dataset: 4,705 observations (1,216 excluded due to missingness).
	•	Performance Metrics:
	•	Null Deviance: 6260.6
	•	Residual Deviance: 6015.6
	•	AIC: 6073.6

Key Findings

The model identifies several significant predictors of woodland visits. Below are the key observations grouped by variable type:

⸻

1. Age Band
	•	25–39: Positive association (\beta = 0.23), marginally significant (p = 0.082).
	•	40–54: No significant effect (p = 0.442).
	•	55–64: Significant negative association (\beta = -0.49, p < 0.001).
	•	65+: Strong negative association (\beta = -0.58, p < 0.001).

Interpretation: Younger adults (25–39) are more likely to visit woodlands compared to older age groups (55+), who are significantly less likely.

⸻

2. Qualification
	•	No qualifications: Significant negative effect (\beta = -0.48, p = 0.003).
	•	Other qualification categories show no significant effects.

Interpretation: Respondents without qualifications are less likely to visit woodlands compared to those with any formal education.

⸻

3. Income
	•	Significant positive effects observed for middle-income groups:
	•	£20,000–29,999 (\beta = 0.21, p = 0.035)
	•	£30,000–39,999 (\beta = 0.24, p = 0.028)
	•	£40,000–49,999 (\beta = 0.25, p = 0.039)
	•	£50,000–59,999 (\beta = 0.29, p = 0.033)
	•	£80,000–99,999: Largest positive effect (\beta = 0.53, p = 0.006).
	•	Highest income groups (£150,000+): No significant association (p = 0.188).

Interpretation: Woodland visits are more common among middle-to-high-income groups, with diminishing returns for the highest earners.

⸻

4. Home IMD Decile (Deprivation Index)
	•	Significant positive associations for deciles 5–10 (less deprived areas):
	•	Decile 7 (\beta = 0.62, p < 0.001)
	•	Decile 8 (\beta = 0.71, p < 0.001)
	•	Decile 10 (\beta = 0.60, p < 0.001)

Interpretation: Respondents living in less deprived areas are significantly more likely to visit woodlands.

⸻

5. Ethnicity
	•	Asian or Asian British: Strong negative association (\beta = -2.10, p < 0.001).
	•	Black or Black British: Negative association (\beta = -1.38, p = 0.036).
	•	Mixed: Negative association (\beta = -0.76), not significant (p = 0.187).
	•	White: No significant association (p = 0.531).

Interpretation: Ethnic minority groups, particularly Asian and Black respondents, are less likely to visit woodlands compared to White respondents.

⸻

Conclusions
	1.	Age and Education: Woodland visits are skewed towards younger and educated populations, with older adults and those without qualifications less likely to participate.
	2.	Income and Area Deprivation: Middle-to-higher-income groups and those living in less deprived areas are significantly more likely to visit woodlands.
	3.	Ethnicity Disparities: There are marked differences in woodland visits across ethnic groups, with minority ethnic groups (Asian and Black) less likely to visit.

Recommendations
	1.	Targeted Outreach: Programs to encourage woodland visits among older adults, low-income groups, and minority ethnic communities could improve inclusivity.
	2.	Accessibility: Address barriers for those in more deprived areas, such as transportation and awareness.
	3.	Cultural Relevance: Develop initiatives that align with the cultural preferences of underrepresented groups to foster engagement.


#### Figure 1: Estimated marginal means for woodland engagement by age

```{r}
#| echo: false
ggeffects::ggemmeans(y2_model, "age_band", rg.limit = 272000) %>%
  dplyr::as_tibble() %>%
  dplyr::mutate(
    predicted = predicted * 100,  # Convert to percentages
    conf.low = conf.low * 100,    # Convert CI lower bound to percentages
    conf.high = conf.high * 100   # Convert CI upper bound to percentages
  ) %>%
  ggplot2::ggplot(ggplot2::aes(x = x, y = predicted)) +
  ggplot2::geom_point(size = 2) +
  ggplot2::geom_linerange(ggplot2::aes(
    ymin = conf.low,
    ymax = conf.high
  ), linewidth = 1) +
  ggplot2::scale_y_continuous(
    labels = scales::percent_format(scale = 1), # Format y-axis as percentage
    limits = c(0, 100)                         # Set y-axis limits to 0-100%
  ) +
  ggplot2::labs(
    x = NULL,
    y = "Percentage",
    subtitle = "Estimated proportion of woodland visitors"
  ) +
  afcharts::theme_af()
```

#### Figure 2: Estimated marginal means for woodland engagement by income

```{r}
#| echo: false
ggeffects::ggemmeans(y2_model, "income", rg.limit = 272000) %>%
  dplyr::as_tibble() %>%
  dplyr::mutate(
    predicted = predicted * 100,  # Convert to percentages
    conf.low = conf.low * 100,    # Convert CI lower bound to percentages
    conf.high = conf.high * 100   # Convert CI upper bound to percentages
  ) %>%
  ggplot2::ggplot(ggplot2::aes(y = x, x = predicted)) +  # Flip x and y
  ggplot2::geom_point(size = 2) +
  ggplot2::geom_linerange(ggplot2::aes(
    xmin = conf.low,  # Flip ymin to xmin
    xmax = conf.high  # Flip ymax to xmax
  ), linewidth = 1) +
  ggplot2::scale_x_continuous(
    labels = scales::percent_format(scale = 1), # Format x-axis as percentage
    limits = c(0, 100)                         # Set x-axis limits to 0-100%
  ) +
  ggplot2::labs(
    x = "Percentage",
    y = NULL,  # Remove y-axis label
    subtitle = "Estimated proportion of woodland visitors"
  ) +
  afcharts::theme_af()
```

#### Figure 3: Estimated marginal means for woodland engagement by home Index of Multiple Deprivation (IMD) decile

```{r}
#| echo: false
ggeffects::ggemmeans(y2_model, "home_imd_decile", rg.limit = 272000) %>%
  dplyr::as_tibble() %>%
  dplyr::mutate(
    predicted = predicted * 100,  # Convert to percentages
    conf.low = conf.low * 100,    # Convert CI lower bound to percentages
    conf.high = conf.high * 100   # Convert CI upper bound to percentages
  ) %>%
  ggplot2::ggplot(ggplot2::aes(y = x, x = predicted)) +  # Flip x and y
  ggplot2::geom_point(size = 2) +
  ggplot2::geom_linerange(ggplot2::aes(
    xmin = conf.low,  # Flip ymin to xmin
    xmax = conf.high  # Flip ymax to xmax
  ), linewidth = 1) +
  ggplot2::scale_x_continuous(
    labels = scales::percent_format(scale = 1), # Format x-axis as percentage
    limits = c(0, 100)                         # Set x-axis limits to 0-100%
  ) +
  ggplot2::labs(
    x = "Percentage",
    y = NULL,  # Remove y-axis label
    subtitle = "Estimated proportion of woodland visitors"
  ) +
  afcharts::theme_af()
```


#### Figure 4: Estimated marginal means for woodland engagement by ethnicity

```{r}
#| echo: false
ggeffects::ggemmeans(y2_model, "ethnicity", rg.limit = 272000) %>%
  dplyr::as_tibble() %>%
  dplyr::mutate(
    predicted = predicted * 100,  # Convert to percentages
    conf.low = conf.low * 100,    # Convert CI lower bound to percentages
    conf.high = conf.high * 100   # Convert CI upper bound to percentages
  ) %>%
  ggplot2::ggplot(ggplot2::aes(y = x, x = predicted)) +  # Flip x and y
  ggplot2::geom_point(size = 2) +
  ggplot2::geom_linerange(ggplot2::aes(
    xmin = conf.low,  # Flip ymin to xmin
    xmax = conf.high  # Flip ymax to xmax
  ), linewidth = 1) +
  ggplot2::scale_x_continuous(
    labels = scales::percent_format(scale = 1), # Format x-axis as percentage
    limits = c(0, 100)                         # Set x-axis limits to 0-100%
  ) +
  ggplot2::labs(
    x = "Percentage",
    y = NULL,  # Remove y-axis label
    subtitle = "Estimated proportion of woodland visitors"
  ) +
  afcharts::theme_af()
```
